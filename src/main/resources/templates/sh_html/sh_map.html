<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>지도</title>
    <!-- headScripts.html 파일 삽입 -->
    <!-- <div th:replace="sh_html/fragments/headScripts :: headScripts"></div> -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript"
        src="https://map.vworld.kr/js/webglMapInit.js.do?version=3.0&apiKey=2D9BDADB-D581-3DB0-991E-11E5985B77CC"></script>
    <link rel="stylesheet" th:href="@{/css/sh_css/sh_map.css}">
</head>

<body>
    <main>
        <div class="mainContainer">
            <div id="vworldMap"></div>
        </div>
    </main>
    <script>
        let map;

        window.onload = function () {
            // 브이월드 지도 초기화
            map = new vw.Map("vworldMap", {
                apiKey: "2D9BDADB-D581-3DB0-991E-11E5985B77CC", // API 키 입력
                basemapType: vw.BasemapType.GRAPHIC
            });
            let options = {
                mapId: "vworldMap", // 지도맵 컨테이너 아이디
                initPosition: new vw.CameraPosition( // 초기 위치
                    new vw.CoordZ(126.921883, 37.524370, 2400),
                    new vw.Direction(0, -90, 0)
                ),
                logo: true, // 하단 로고 설정. true : 표출, false : 미표출
                navigation: true // 오른쪽 상단 네비게이션 설정. true : 표출, false : 미표출
            };
            map.setOption(options); //3D지도 초기 옵션 설정
            map.setMapId("vworldMap"); //지도가 탑재될 컨테이너 설정 가능
            map.setInitPosition(new vw.CameraPosition( //초기 위치설정 가능
                new vw.CoordZ(126.921883, 37.524370, 24000),
                new vw.Direction(0, -90, 0)
            ));
            // map.setCenterAndZoom(new vw.Coord(127.024612, 37.532600), 7); // 대한민국 중심 좌표
            map.start(); // 설정 항목을 가지고 최종지도생성       

            // 행정 경계 데이터를 가져오기
            // fetch("https://api.vworld.kr/req/wms?key=2D9BDADB-D581-3DB0-991E-11E5985B77CC&SERVICE=WMS&REQUEST=GetMap&VERSION=1.3.0&LAYERS=lp_pa_cbnd_bonbun,lp_pa_cbnd_bubun&STYLES=lp_pa_cbnd_bonbun_line,lp_pa_cbnd_bubun_line&CRS=EPSG:900913&BBOX=14133818.022824,4520485.8511757,14134123.770937,4520791.5992888&WIDTH=256&HEIGHT=256&FORMAT=image/png&TRANSPARENT=false&BGCOLOR=0xFFFFFF&EXCEPTIONS=text/xml&domain=localhost")
            // fetch("https://api.vworld.kr/req/wfs?service=WFS&version=2.0.0&request=GetFeature&typeName=lt_c_adsido_info&output=json&key=2D9BDADB-D581-3DB0-991E-11E5985B77CC&domain=localhost")
            //         .then(response => response.json())
            //         .then(data => {
            //             console.log(data);
            //             // GeoJSON 데이터를 지도에 추가
            //             var boundaryLayer = new vw.layer.Vector({
            //                 source: new vw.source.Vector({
            //                     features: new vw.format.GeoJSON().readFeatures(data)
            //                 }),
            //                 style: new vw.style.Style({
            //                     stroke: new vw.style.Stroke({
            //                         color: '#ff0000', // 경계선 색상
            //                         width: 2 // 경계선 두께
            //                     }),
            //                     fill: new vw.style.Fill({
            //                         color: 'rgba(255, 0, 0, 0.1)' // 영역 채우기 색상 (투명도 포함)
            //                     })
            //                 })
            //             });
            //             map.addLayer(boundaryLayer);
            //         })
            //         .catch(error => console.error("행정 경계 데이터를 가져오는 중 오류 발생:", error));
            // fetch("http://localhost:8080/sh_api/vworldWFS?service=WFS&version=1.3.0&request=GetFeature&typeName=lt_c_adsido_info&output=json&key=2D9BDADB-D581-3DB0-991E-11E5985B77CC&domain=localhost")
            //     .then(response => response.json())
            //     .then(data => {
            //         console.log(data);
            //         // 데이터 처리
            //     })
            //     .catch(error => console.error("오류 발생:", error));

            $.ajax({
                url:'http://localhost:8080/sh_api/vworldWFS?service=WFS&version=2.0.0&request=GetFeature&typeName=lt_c_adsido_info&output=json&key=2D9BDADB-D581-3DB0-991E-11E5985B77CC&domain=localhost',
                type:'POST',
                contentType: 'application/json',
                success: function (data) {
                    console.log(data);
                },
                error: function() {
                    console.log('error')
                }
            });
        };
    </script>
    <!-- <script>
        //예시
        let options = {
            mapId: "vworldMap", // 지도맵 컨테이너 아이디
            initPosition: new vw.CameraPosition( // 초기 위치
                new vw.CoordZ(126.921883, 37.524370, 2400),
                new vw.Direction(0, -90, 0)
            ),
            logo: true, // 하단 로고 설정. true : 표출, false : 미표출
            navigation: true // 오른쪽 상단 네비게이션 설정. true : 표출, false : 미표출
        };

        let map = new vw.Map();
        map.setOption(options); //3D지도 초기 옵션 설정
        map.setMapId("vworldMap"); //지도가 탑재될 컨테이너 설정 가능
        map.setInitPosition(new vw.CameraPosition( //초기 위치설정 가능
            new vw.CoordZ(126.921883, 37.524370, 24000),
            new vw.Direction(0, -90, 0)
        ));

        // 로고 및 네비 설정.
        map.setLogoVisible(true);
        map.setNavigationZoomVisible(true);
        map.start(); // 설정 항목을 가지고 최종지도생성       
    </script> -->
</body>

</html>